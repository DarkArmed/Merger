# -*- coding: UTF-8 -*-
import random
import timeit
from merger import Merger
from spliter import Spliter
from helper import *



def test(test_case):
    merger = Merger(test_case)
    # codes = merger.get_codes(3)

    for k in range(10, 9, -1):
        value_sum = 0
        for code, num in merger.merge_result(k).items():
            value_sum += num
        print 'k =', k, merger.merge_result(k), ' \tMerged codes:', len(merger.merge_result(k)), ' \tTotal value:', value_sum
        # print merger.merge_result(k)['01569']

# 023.026.028.036.038.068.145.169. 236.238.268.368.456.459.469.569g100y
#  146.149.156.159g60y
#  013.014.015.017.034.035.037.045.047.057.134.135.136.137.139.147.157.345.347.357.369. 457g40y
#  258g10y

text = u'023.026.028.036.038.068.145.169. 236.238.268.368.456.459.469.569g100y 146.149.156.159g60y 013.014.015.017.034.035.037.045.047.057.134.135.136.137.139.147.157.345.347.357.369. 457g40y258g10y'

text = u'345 357 456各10元 039 069 137 239 249 269 279 348 349 378 379 457 468 469 479各6元 017 068 078 079 126 134 146 167 235 238 256 268 278各2元 279=300元 357=340元 358=320元 135=140元 257=100元 237 345各80元 259 347各40元  457 579各60元 125 139 145 179 258 289 379 389 569各40元 024 157 245 246  468各20元157=6元 139=4元 258=20元 028=10元068 158 248 358 378 239各10元689 679 079 069 389 359 369 589各20元026=20元  479=6元 268=14元 238 389 239 236 239各2元389 067 234 124各20元049=20元179 479 478各6元  256.257各40元 235=20元 679.689.069.079.389.359.369.379.589各10元149.10元123.10元760.20元014 256 023 456 267 025 124 各10元 012 085 148 238 247 168 249 258 357 061 269 359 各4元 568.10元 157.20元456.469.各10元 148.4元 478.60元016.025.026.046.056.095.076.086.146.245.246.346.368.459.467.468.589.678.986各20元268=10元 267=10元 356 158各10元234 135 045 126 036 027 018 568 478 469 379 289各4元 568 056 156 256 356 456 567 569各80元 016 026 167各20元 01569=20元 056=10元267=80元257=64元089=50元 128=100元 \n479=80元 136=20元 067 256 058 012各100元079=50元 169=10元 467 179各20元 247 357各10元 257=20元 679=60元023=20元 125 127 268 179 078 178各10元 256=20元 479=20元 128=100元 258=100元257.20元 235.245.257.458.578.095.159.359.459.579.236.246.267.468.678.096.196.963.496.976各4元 014=4元  \n278=6元 2469=40元 492=50元 056=100元  278=4元129=50元 '

text2 = u'345 357 456各10元 039 069 137 239 249 269 279 348 349 378 379 457 468 469 479各6元 017 068 078 079 126 134 146 167 235 238 256 268 278各2元 279=300元 357=340元 358=320元 135=140元 257=100元 237 345各80元 259 347各40元  457 579各60元 125 139 145 179 258 289 379 389 569各40元 024 157 245 246  468各20元157=6元 139=4元 258=20元 028=10元068 158 248 358 378 239各10元689 679 079 069 389 359 369 589各20元026=20元  479=6元 268=14元 238 389 239 236 239各2元389 067 234 124各20元049=20元179 479 478各6元  256.257各40元 235=20元 679.689.069.079.389.359.369.379.589各10元149.10元123.10元760.20元014 256 023 456 267 025 124 各10元 012 085 148 238 247 168 249 258 357 061 269 359 各4元 568.10元 157.20元456.469.各10元 148.4元 478.60元016.025.026.046.056.095.076.086.146.245.246.346.368.459.467.468.589.678.986各20元268=10元 267=10元 356 158各10元234 135 045 126 036 027 018 568 478 469 379 289各4元 568 056 156 256 356 456 567 569各80元 016 026 167各20元 056=10元267=80元257=64元089=50元 128=100元 \n479=80元 136=20元 067 256 058 012各100元079=50元 169=10元 467 179各20元 247 357各10元 257=20元 679=60元023=20元 125 127 268 179 078 178各10元 256=20元 479=20元 128=100元 258=100元257.20元 235.245.257.458.578.095.159.359.459.579.236.246.267.468.678.096.196.963.496.976各4元 014=4元  \n278=6元 492=50元 056=100元  278=4元129=50元 '

# print text.encode('utf-8')
case = decode(unicode(text))

# print case
print
# print [code for code in case if len(code) > 3]

value = 0
for code, num in case.items():
    print code, num, 
    value += num
print
print value

print str(timeit.timeit('test(case)', 'from __main__ import test, case', number=1)) + 's used.'

TEST_CASES = [
                ['012', '013', '023', '123'],
                ['012', '013', '023', '124', '134', '234'],
                ['012', '013', '023', '123', '124', '134', '234'],
                ['012', '013', '023', '123', '123', '124', '134', '234'],
                ['012', '013', '014', '023', '024', '034', '123', '124', '134', '234'],
                ['012', '023', '013', '123', '123', '234', '134', '124', '125', '127', '157', '257', '125', '127', '157'],
                ['012', '023', '013', '123', '123', '234', '134', '124', '125', '125', '127', '157', '257', '125', '127', '157'],
             ]

codes = Merger([]).get_codes(3)
case = TEST_CASES[0]
# case = [to_string(random.choice(codes)) for dummy_i in range(10000)]
# case = TEST_CASES[3] * 10
# case = TEST_CASES[0] + TEST_CASES[4]
# case = TEST_CASES[6]

# print str(timeit.timeit('test(case)', 'from __main__ import test, case', number=1)) + 's used.'

# print len(" sdsd\n\n \t".strip())
